(window.webpackJsonp=window.webpackJsonp||[]).push([[131],{EvBA:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e._self._c;return t("div",[t("v-app-bar",{staticClass:"px-sm text-left shadow-sm",staticStyle:{"z-index":"6"},attrs:{color:e.getThemeMode.appBarColor,dark:e.darkContrast,app:"",flat:"",height:"75"}},[e.account.id?t("v-app-bar-nav-icon",{directives:[{name:"ripple",rawName:"v-ripple",value:{class:"primary--text"},expression:"{class: 'primary--text'}"}],on:{click:e.toggleVerticalSidebarDrawer}},[e._t("default",(function(){return[t("v-tooltip",{attrs:{color:"primary"},scopedSlots:e._u([{key:"activator",fn:function(n){var o=n.on,r=n.attrs;return[t("v-icon",e._g(e._b({},"v-icon",r,!1),o),[e._v("mdi-view-dashboard")])]}}],null,!1,3539084310)},[e._v(" "),t("span",[e._v("Toggle dashboard menu")])])]}))],2):t("v-avatar",{attrs:{tile:"",href:"/"}},[t("a",{attrs:{href:"/"}},[t("v-img",{attrs:{src:"/assets/images/landing-pages/peerj-bio-logo.svg",alt:"PeerJ","max-width":"42px"}})],1)]),e._v(" "),e.navWidth>761?t("div",{staticClass:"d-flex"},[t("JournalNav",{attrs:{maxHeight:"700"}}),e._v(" "),t("PublishNav",{attrs:{maxHeight:"700"}}),e._v(" "),t("CommunitiesNav",{attrs:{maxHeight:"700"}})],1):t("vue-navigation-bar",{staticClass:"mt-0",attrs:{options:e.navbarOptions},scopedSlots:e._u([{key:"custom-section",fn:function(){return[t("JournalNav",{attrs:{maxHeight:"60vh"}}),e._v(" "),t("PublishNav",{attrs:{maxHeight:"60vh"}}),e._v(" "),t("CommunitiesNav",{attrs:{maxHeight:"60vh"}})]},proxy:!0}])}),e._v(" "),t("v-progress-linear",{attrs:{active:e.getThemeMode.isLoading,indeterminate:e.getThemeMode.isLoading,absolute:"",bottom:"",color:"primary"}}),e._v(" "),t("v-spacer"),e._v(" "),e.account.id?e._e():t("v-btn",{attrs:{href:"/login/",text:""}},[e._v("Login")]),e._v(" "),e.account.id&&e.showTokens?t("v-badge",{attrs:{content:"$"+e.tokenValue.toLocaleString(),left:"",inline:"",color:e.tokenValue>0?"primary":""}},[t("v-btn",{staticClass:"ml-n3",attrs:{icon:""},on:{click:function(t){e.showTokenDialog=!e.showTokenDialog}}},[t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(n){var o=n.on,r=n.attrs;return[t("v-icon",e._g(e._b({attrs:{size:"26",color:e.tokenValue>0?"primary":""}},"v-icon",r,!1),o),[e._v("mdi-circle-multiple")])]}}],null,!1,574491206)},[e._v(" "),t("span",[e._v("Manage tokens")])])],1)],1):e._e(),e._v(" "),e.account.checkouts>0?t("v-badge",{attrs:{bordered:"",overlap:"",content:e.account.checkouts,color:"error","offset-x":"22","offset-y":"22"}},[t("v-btn",{attrs:{icon:"",href:"/payment/"}},[t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(n){var o=n.on,r=n.attrs;return[t("v-icon",e._g(e._b({},"v-icon",r,!1),o),[e._v("mdi-cart")])]}}],null,!1,1497247670)},[e._v(" "),t("span",[e._v("View checkout items")])])],1)],1):e._e(),e._v(" "),e.unreadNotificationCount>0?t("v-badge",{attrs:{bordered:"",overlap:"",content:e.unreadNotificationCount,color:"error","offset-x":"22","offset-y":"22"}},[t("v-btn",{attrs:{icon:""},on:{click:function(t){e.notificationDrawer=!e.notificationDrawer}}},[t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(n){var o=n.on,r=n.attrs;return[t("v-icon",e._g(e._b({},"v-icon",r,!1),o),[e._v("mdi-bell")])]}}],null,!1,1429516213)},[e._v(" "),t("span",[e._v("View notifications")])])],1)],1):e.account.id?t("v-btn",{attrs:{icon:""},on:{click:function(t){e.notificationDrawer=!e.notificationDrawer}}},[t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(n){var o=n.on,r=n.attrs;return[t("v-icon",e._g(e._b({},"v-icon",r,!1),o),[e._v("mdi-bell")])]}}])},[e._v(" "),t("span",[e._v("View notifications")])])],1):e._e(),e._v(" "),t("v-btn",{attrs:{icon:""},on:{click:function(t){e.searchDrawer=!e.searchDrawer}}},[t("v-icon",[e._v("mdi-magnify")])],1),e._v(" "),e.account.id?t("v-chip",{staticClass:"transparent py-5",attrs:{pill:""},on:{click:function(t){e.userDrawer=!e.userDrawer}}},[t("span",{directives:[{name:"show",rawName:"v-show",value:!e.$vuetify.breakpoint.mobile,expression:"!$vuetify.breakpoint.mobile"}]},[e._v(e._s(e.account.name))]),e._v(" "),t("v-avatar",{staticClass:"ml-2"},[t("v-img",{attrs:{src:e.account.photo}})],1)],1):e._e()],1),e._v(" "),e.account.id?t("v-navigation-drawer",{attrs:{fixed:"",right:"",height:"100%",temporary:"",floating:"",width:"350"},scopedSlots:e._u([{key:"append",fn:function(){return[t("div",{staticClass:"my-4 mx-4"},[t("base-hover-button",{attrs:{text:"Logout",block:"","bg-color":"primary lighten-5 primary--text","icon-name":"mdi-logout"},nativeOn:{click:function(t){return e.logoutUser.apply(null,arguments)}}})],1)]},proxy:!0}],null,!1,229713062),model:{value:e.userDrawer,callback:function(t){e.userDrawer=t},expression:"userDrawer"}},[t("user-drawer",{on:{toggleTokenDialog:function(t){e.showTokenDialog=!e.showTokenDialog}},scopedSlots:e._u([{key:"userDrawerCloseButton",fn:function(){return[t("v-btn",{attrs:{icon:"",color:""},on:{click:function(t){t.stopPropagation(),e.userDrawer=!e.userDrawer}}},[t("v-icon",[e._v("mdi-close")])],1)]},proxy:!0}],null,!1,2346391380)})],1):e._e(),e._v(" "),t("v-navigation-drawer",{attrs:{fixed:"",right:"",height:"100%",temporary:"",floating:"",width:"350"},scopedSlots:e._u([e.showNotificationLink?{key:"append",fn:function(){return[t("div",{staticClass:"my-4 mx-4"},[t("base-hover-button",{attrs:{"click-event":e.toNotificationsPage,text:"View All Notifications",block:"",color:"primary lighten-5 primary--text"}})],1)]},proxy:!0}:null],null,!0),model:{value:e.notificationDrawer,callback:function(t){e.notificationDrawer=t},expression:"notificationDrawer"}},[t("notification-drawer",{attrs:{"is-open":e.notificationDrawer},on:{unreadNotificationCount:e.updateNotificationCount,showNotificationLink:function(t){e.showNotificationLink=!e.showNotificationLink}},scopedSlots:e._u([{key:"notificationDrawerCloseButton",fn:function(){return[t("v-btn",{attrs:{icon:"",color:""},on:{click:function(t){t.stopPropagation(),e.notificationDrawer=!e.notificationDrawer}}},[t("v-icon",[e._v("mdi-close")])],1)]},proxy:!0}])})],1),e._v(" "),t("v-navigation-drawer",{attrs:{fixed:"",right:"",height:"100%",temporary:"",floating:"",width:"380"},model:{value:e.searchDrawer,callback:function(t){e.searchDrawer=t},expression:"searchDrawer"}},[t("search-drawer",{attrs:{"is-open":e.searchDrawer,"search-filter":e.searchFilter},scopedSlots:e._u([{key:"searchDrawerCloseButton",fn:function(){return[t("v-btn",{staticClass:"mb-2",attrs:{icon:"",color:""},on:{click:function(t){t.stopPropagation(),e.searchDrawer=!e.searchDrawer}}},[t("v-icon",[e._v("mdi-close")])],1)]},proxy:!0}])})],1),e._v(" "),e.showTokenDialog?t("TokenDialog",{attrs:{openTokenDialog:e.showTokenDialog},on:{"update:openTokenDialog":function(t){e.showTokenDialog=t},"update:open-token-dialog":function(t){e.showTokenDialog=t},closeTokenDialog:function(t){e.showTokenDialog=!1}}}):e._e(),e._v(" "),e.loadGroupDiscountDialog?t("GroupDiscountDialog",{attrs:{openGroupDiscountDialog:e.showGroupDialog,submission:e.groupSubmission},on:{"update:openGroupDiscountDialog":function(t){e.showGroupDialog=t},"update:open-group-discount-dialog":function(t){e.showGroupDialog=t},closeGroupDiscountDialog:function(t){e.showGroupDialog=!1}}}):e._e()],1)};o._withStripped=!0;var r=n("RIqP"),i=n.n(r),a=n("lSNA"),s=n.n(a),u=n("L2JU"),c=n("sEfC"),l=n.n(c),d=n("bbSu"),g=n("vDqi"),p=n.n(g);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={name:"VerticalAppBar",mixins:[n("xxaF").a],components:{UserDrawer:function(){return n.e(165).then(n.bind(null,"DtlF"))},NotificationDrawer:function(){return n.e(164).then(n.bind(null,"5v+H"))},SearchDrawer:function(){return n.e(126).then(n.bind(null,"S7B1"))},GroupDiscountDialog:function(){return n.e(88).then(n.bind(null,"/wn7"))},TokenDialog:function(){return Promise.all([n.e(0),n.e(104)]).then(n.bind(null,"U0M4"))},JournalNav:function(){return n.e(133).then(n.bind(null,"DG6X"))},PublishNav:function(){return n.e(134).then(n.bind(null,"dxWX"))},CommunitiesNav:function(){return n.e(132).then(n.bind(null,"12/0"))}},beforeDestroy:function(){document.removeEventListener("keydown",this._keyListener),d.a.$off("userDrawerToggled"),d.a.$off("searchDrawerToggled");var e=document.getElementById("group-discount-btn");e&&e.removeEventListener("click")},beforeMount:function(){document.removeEventListener("keydown",this._keyListener),d.a.$off("userDrawerToggled"),d.a.$off("searchDrawerToggled")},created:function(){var e=document.querySelector("#header-skeleton");e&&(e.style.display="none");var t=document.querySelector("#group-manage-discount");t&&this.handleGroupSubmissionDiscount(t)},mounted:function(){var e=this;this._keyListener=function(e){var t=!1,n=document.activeElement;!n||"INPUT"!==n.tagName&&"TEXTAREA"!==n.tagName||(t=!0),(!t&&"/"===e.key||t&&"/"===e.key&&(e.ctrlKey||e.metaKey))&&(this.searchDrawer=!this.searchDrawer)},this.account.id&&setTimeout((function(){e.getUserTokens()}),5e3),document.addEventListener("keydown",l()(this._keyListener.bind(this),500,{leading:!0})),d.a.$on("userDrawerToggled",(function(){e.userDrawer=!e.userDrawer})),d.a.$on("searchDrawerToggled",this.performSearch),this.createPublicReviewButton()},computed:f(f({},Object(u.c)(["getThemeMode","getVuetifyPreset"])),{},{navWidth:function(){return this.$vuetify.breakpoint.width},darkContrast:function(){var e=this.getThemeMode.appBarColor;if(e.startsWith("#")||(e=this.getVuetifyPreset.theme.themes[this.theme][e]),e)return"white"===this.getContrastYIQ(e)},navMenuOptions:function(){return this.account.id?[{}]:[{type:"button",text:"Signup",path:"/signup/",class:"button-red"},{type:"button",text:"Login",path:"/login/",iconRight:'<svg id="i-arrow-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="32" height="32" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"> <path d="M22 6 L30 16 22 26 M30 16 L2 16" /> </svg>'}]},navbarOptions:function(){return{elementId:"main-navbar",isUsingVueRouter:!1,mobileBreakpoint:760,brandImagePath:"./",brandImageAltText:"brand-image",collapseButtonOpenColor:"#661c23",collapseButtonCloseColor:"#661c23",showBrandImageInMobilePopup:!0,ariaLabelMainNav:"Main Navigation",tooltipAnimationType:"shift-away",menuOptionsLeft:this.navMenuOptions}},tokenValue:function(){var e={allocated:0,remaining:0,transferred:0,purchased:0,value:0};if(this.tokens)return this.tokens.forEach((function(t){t.article||(e.allocated+=t.allocated,e.remaining+=t.remaining,e.transferred+=t.transferred,t.paid&&(e.purchased+=t.allocated),e.value+=t.value*t.remaining/100)})),e.value}}),data:function(){return{showArticlePageGroupAlert:!1,group:{id:null,slug:null,name:null},userDrawer:!1,searchFilter:null,notificationDrawer:!1,showNotificationLink:!1,searchDrawer:!1,unreadNotificationCount:0,showTokenDialog:!1,showTokens:!1,groupSubmission:null,loadGroupDiscountDialog:!1,showGroupDialog:!1}},methods:f(f({},Object(u.b)(["changeVerticalSidebarDrawer","changeVerticalSidebarMini","signOut"])),{},{createPublicReviewButton:function(){setTimeout((function(){var e=document.querySelector("#peer-review-history"),t=window.location.href;if(!e&&t.includes("/articles")){var n=document.querySelector("#article-pub-date-cont");if(n){var o,r=document.createElement("a"),a=t.split("?")[0],s=a.endsWith("/")?a+"reviews":a+"/reviews";r.setAttribute("href",s);var u="mt-3 btn btn-article btn-download".split(" ");(o=r.classList).add.apply(o,i()(u)),r.setAttribute("id","peer-review-history"),r.innerHTML="Read the peer review reports",r.setAttribute("ref","peer-review-history"),r.setAttribute("target","_blank");var c=document.createElement("span");c.classList.add("icon-external-link"),c.classList.add("mr-2"),r.prepend(c),n.parentNode.insertBefore(r,n.nextSibling)}}}),400)},getUserTokens:function(){var e=this;this.fetchTokens().then((function(){e.tokens&&(e.showTokens=!0)}))},handleArticlePageGroupAlert:function(){},handleGroupSubmissionDiscount:function(e){var t=this,n=(e.getAttribute("data-group"),e.getAttribute("data-article"));n&&p.a.get("/groups/view-discount/"+n).then((function(n){if(n.data.submission){t.groupSubmission=n.data.submission;var o=document.createElement("button");o.classList.add("btn"),o.setAttribute("id","group-discount-btn"),o.innerHTML="Manage discount",o.setAttribute("ref","group-discount-btn"),e.appendChild(o),t.$nextTick((function(){var e=document.getElementById("group-discount-btn");e&&e.addEventListener("click",(function(e){t.loadGroupDiscountDialog=!0,t.showGroupDialog=!0}))}))}else{var r=document.createElement("span"),i="No abstract found in Hub. Needs curation?";"Undefined"!==n.data.eligible&&(i="Discount eligible: "+n.data.eligible),"Undefined"!==n.data.hasSubmission&&(i=i+" / Has known Hub abstract: "+n.data.hasSubmission),r.innerHTML=i,e.appendChild(r)}})).catch((function(e){console.log("error")}))},performSearch:function(e){this.searchFilter=e,this.searchDrawer=!this.searchDrawer},toggleVerticalSidebarDrawer:function(){d.a.$emit("expandedSidebarToggled")},logoutUser:function(){window.location.href="/logout"},updateNotificationCount:function(e){this.unreadNotificationCount=e},toNotificationsPage:function(){window.location.href="/feed/notification"}})},k=(n("p7HK"),n("KHd+")),m=n("ZUTo"),b=n.n(m),w=n("QNyc"),T=n("W8H5"),D=n("ghKu"),y=n("TKb1"),E=n("gzZi"),_=n("zCDB"),x=n("Ey0z"),O=n("rdoz"),P=n("93RO"),L=n("jjY0"),S=n("L6Q5"),M=n("Oi+f"),N=n("Jpri"),A=n.n(N),j=n("VgeV"),C=Object(k.a)(h,o,[],!1,null,null,null);t.default=C.exports;b()(C,{VAppBar:w.a,VAppBarNavIcon:T.a,VAvatar:D.a,VBadge:y.a,VBtn:E.a,VChip:_.a,VIcon:x.a,VImg:O.a,VNavigationDrawer:P.a,VProgressLinear:L.a,VSpacer:S.a,VTooltip:M.a}),A()(C,{Ripple:j.a})},P7FQ:function(e,t,n){},p7HK:function(e,t,n){"use strict";n("P7FQ")},xxaF:function(e,t,n){"use strict";var o=n("o0o1"),r=n.n(o),i=n("yXPU"),a=n.n(i),s=n("lSNA"),u=n.n(s),c=n("WTW0"),l=n("L2JU"),d=n("E+oP"),g=n.n(d);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a={name:"TokenMixin",servicePrefix:"TokenMixin",data:function(){return{activeTokenEvent:null,fundingDialogPanels:[1],fundingMessage:null,fundingAmountOption:null,otherFundingAmount:0,tokenEventId:null,tokenGroup:null,requestStatus:null,requestStatuses:[{title:"New",aggName:"requestStatus",filter:"new"},{title:"Resubmitted",aggName:"requestStatus",filter:"resubmitted"},{title:"Reviewing",aggName:"requestStatus",filter:"reviewing"},{title:"Returned to user",aggName:"requestStatus",filter:"clarifying"},{title:"Declined",aggName:"requestStatus",filter:"declined"},{title:"Award unused",aggName:"requestStatus",filter:"awarded"},{title:"Award used",aggName:"requestStatus",filter:"award used"},{title:"Award returned",aggName:"requestStatus",filter:"award returned"}],tokenEventQueryOptions:{requestToken:null,sortBy:["requestUpdated"],sortDesc:[!0],page:1,itemsPerPage:15,paginationButtonsMax:7,totalItems:0,reset:!0},tokenMessageQueryOptions:{requestToken:null,sortBy:["created"],sortDesc:[!0],page:1,itemsPerPage:15,paginationButtonsMax:7,totalItems:0,reset:!0}}},created:function(){},watch:{tokenEvents:function(){this.tokenEventQueryOptions.totalItems=this.totalItemsTokenEvents}},computed:v(v(v(v(v(v(v({},Object(l.c)("tokenEvents",{tokenEvents:"list",findTokenEvent:"find"})),Object(c.c)("tokenEvents",{isLoadingTokenEvents:"isLoading",errorTokenEvents:"error",updatedTokenEvent:"updated",resetListTokenEvents:"resetList",totalItemsTokenEvents:"totalItems",violationsTokenEvents:"violations",tokenEventAggregations:"aggregations"})),Object(l.c)("tokenEventMessages",{tokenMessages:"list"})),Object(c.c)("tokenEventMessages",{isLoadingTokenMessages:"isLoading",errorTokenMessages:"error",updatedTokenMessage:"updated",resetListTokenMessages:"resetList",totalItemsTokenMessages:"totalItems",violationsTokenMessages:"violations",tokenMessageAggregations:"aggregations"})),Object(l.c)("tokens",{findToken:"find",tokens:"list"})),Object(c.c)("tokens",{isLoadingTokens:"isLoading",errorTokens:"error",updatedToken:"updated",createdToken:"createdResource",resetListTokens:"resetList",totalItemsTokens:"totalItems",violationsTokens:"violations"})),{},{groupTokenEvents:function(){return this.tokenEvents.filter((function(e){return e.groupIdDebitedFrom||e.groupIdCreditedTo}))},userTokenEvents:function(){return this.tokenEvents.filter((function(e){return e.groupIdDebitedFrom||e.groupIdCreditedTo}))},isLoadingTokenData:function(){return this.isLoadingTokens||this.isLoadingTokenEvents||this.isLoadingArticles},requestBuckets:function(){var e=this,t=[];return this.tokenEventAggregations&&this.tokenEventAggregations.requestStatus&&this.requestStatuses.forEach((function(n){n.count=0;var o=e.tokenEventAggregations.requestStatus.buckets.find((function(e){return e.key===n.filter}));o&&(n.count=o.doc_count),t.push(n)})),t}}),methods:v(v(v(v({},Object(l.b)("tokenEvents",{getTokenEvents:"fetchAll",retrieveTokenEvent:"load",patchTokenEvents:"patch",updateTokenEvents:"update",updateResetTokenEvents:"resetUpdate"})),Object(l.b)("tokenEventMessages",{createTokenMessage:"create",getTokenMessages:"fetchAll",retrieveTokenMessages:"load",patchTokenMessages:"patch",updateTokenMessage:"update",updateResetTokenMessages:"resetUpdate"})),Object(l.b)("tokens",{createToken:"create",getTokens:"fetchAll",retrieveTokens:"load",patchToken:"patch",updateToken:"update",updateResetTokens:"resetUpdate"})),{},{fetchTokens:function(){var e=this;return a()(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.account.id){t.next=2;break}return t.abrupt("return");case 2:if(e.isLoadingTokens){t.next=7;break}return e.resetListTokens=!0,t.next=6,e.getTokens({user:e.account.id,"exists[article]":!1,"exists[group]":!1,itemsPerPage:50});case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))()},fetchTokensByArticle:function(e){var t=this;return a()(r.a.mark((function n(){return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.getTokens({article:e,itemsPerPage:100});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},fetchTokenEvents:function(){var e=arguments,t=this;return a()(r.a.mark((function n(){var o,i,a,s,u,c,l,d;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.length>0&&void 0!==e[0]?e[0]:t.tokenEventQueryOptions,i=o.page,a=o.itemsPerPage,s=o.sortBy,u=o.sortDesc,"getTokenEvents"!==(c=e.length>1&&void 0!==e[1]?e[1]:"getTokenEvents")||!t.isLoadingTokenEvents){n.next=4;break}return n.abrupt("return");case 4:if(l="tokenEventQueryOptions","getTokenMessage"!==c){n.next=9;break}if(l="tokenMessageQueryOptions",!t.isLoadingTokenMessages){n.next=9;break}return n.abrupt("return");case 9:return t.resetListTokenEvents=!0,d={itemsPerPage:100},a&&a>0&&(d=v(v({},d),{},{itemsPerPage:a,page:i})),g()(s)||g()(u)||(d["order[".concat(s[0],"]")]=u[0]?"desc":"asc"),t[l].requestToken&&(d.token=t[l].requestToken),"getTokenEvents"===c?t.tokenGroup?(d.group=t.tokenGroup,t.requestStatus&&(d.requestStatus=t.requestStatus)):d.user=t.account.id:"getTokenMessages"===c&&(d.tokenEvent=t.tokenEventId),n.next=17,t[c](d).then((function(){t[l].sortBy=s,t[l].sortDesc=u,t[l].itemsPerPage=a,t[l].totalItems=t.totalItems,t[l].pagination={page:t[l].page,itemsPerPage:t[l].itemsPerPage,pageCount:5,itemsLength:t[l].totalItems}}));case 17:case"end":return n.stop()}}),n)})))()},addTokenMessage:function(e,t,n){var o={messageType:"to-author",content:[e],tokenEvent:t["@id"]};this.createTokenMessage(o)},updateFundingRequestEvent:function(e){var t=this;if(this.activeTokenEvent&&!this.isLoadingTokenEvents){this.isLoadingTokenEvents=!0;var n=this.$refs.tokenRequestForm;n.$v.$touch(),n.$v.$invalid?this.isLoadingTokenEvents=!1:(this.fundingMessage=n.authorMessage,this.fundingAmountOption=n.dataAmountOption,this.otherFundingAmount=n.dataOtherAmount,"awarded"===n.item.event.requestStatus&&(n.item.event.fundedAmount="otherAmount"===this.fundingAmountOption?100*this.otherFundingAmount:this.activeTokenEvent.amount),this.updateTokenEvents(n.item.event).then((function(){t.showMessage&&t.showMessage("Update saved"),t.fundingDialogPanels&&(t.fundingDialogPanels=[]),t.activeTokenEvent=t.updatedTokenEvent,t.fetchTokenEvents(),t.fundingMessage&&(t.addTokenMessage(t.fundingMessage,t.activeTokenEvent,e),t.fundingMessage=null,n.authorMessage=null)})).catch((function(e){console.log(e)})).finally((function(){return t.isLoadingTokenEvents=!1})))}}})}}}]);